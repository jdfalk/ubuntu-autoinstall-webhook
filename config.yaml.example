# Ubuntu Autoinstall Webhook Configuration

# Server settings
server:
  host: "0.0.0.0"
  port: 8080

# Database settings
database:
  type: "sqlite3"  # Options: sqlite3, cockroachdb
  sqlite3:
    path: "/var/lib/ubuntu-autoinstall-webhook/database.sqlite"
  cockroachdb:
    host: "localhost"
    port: 26257
    database: "ubuntu_autoinstall"
    user: "root"
    ssl_mode: "disable"

# File paths
paths:
  ipxe_boot: "/var/www/html/ipxe/boot/"
  cloud_init: "/var/www/html/cloud-init/"

# Authentication
auth:
  grpc:
    mutual_tls: false
    preshared_secret: ""
    ip_matching: []
    mac_matching: []

# RBAC
rbac:
  roles:
    - name: "admin"
      permissions: ["logging", "ide", "configuration"]
    - name: "user"
      permissions: ["logging"]

# Observability
observability:
  tracing:
    enabled: true
    exporter: "jaeger"
    jaeger:
      endpoint: "http://localhost:14268/api/traces"
  metrics:
    enabled: true
    port: 9090
  logging:
    level: "info"
    format: "json"

# Kubernetes
kubernetes:
  enabled: false
  namespace: "default"
  configmap_name: "ubuntu-autoinstall-webhook-config"
  lease_name: "ubuntu-autoinstall-webhook-lease"

# DNSMasq Watcher
dnsmasq_watcher:
  log_source: "file"  # Options: file, journald, kubernetes
  log_path: "/var/log/dnsmasq.log"
  poll_interval: 5  # seconds

# Microservices
microservices:
  file_editor:
    enabled: true
  database:
    enabled: true
  configuration:
    enabled: true
  dnsmasq_watcher:
    enabled: true
  webserver:
    enabled: true
